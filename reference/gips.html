<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Create a gips object.
This object will consist of data and all other information needed to find
the most likely invariant permutation. The optimization itself
will not be performed. One must call the find_MAP()
function to do it. See examples below."><title>The constructor of a gips class. — gips • gips</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The constructor of a gips class. — gips"><meta property="og:description" content="Create a gips object.
This object will consist of data and all other information needed to find
the most likely invariant permutation. The optimization itself
will not be performed. One must call the find_MAP()
function to do it. See examples below."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gips</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/PrzeChoj/gips/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>The constructor of a <code>gips</code> class.</h1>
      <small class="dont-index">Source: <a href="https://github.com/PrzeChoj/gips/blob/HEAD/R/gips_class.R" class="external-link"><code>R/gips_class.R</code></a></small>
      <div class="d-none name"><code>gips.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create a <code>gips</code> object.
This object will consist of data and all other information needed to find
the most likely invariant permutation. The optimization itself
will not be performed. One must call the <code><a href="find_MAP.html">find_MAP()</a></code>
function to do it. See examples below.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gips</span><span class="op">(</span></span>
<span>  <span class="va">S</span>,</span>
<span>  <span class="va">number_of_observations</span>,</span>
<span>  delta <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  D_matrix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  was_mean_estimated <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  perm <span class="op">=</span> <span class="st">""</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">new_gips</span><span class="op">(</span></span>
<span>  <span class="va">list_of_gips_perm</span>,</span>
<span>  <span class="va">S</span>,</span>
<span>  <span class="va">number_of_observations</span>,</span>
<span>  <span class="va">delta</span>,</span>
<span>  <span class="va">D_matrix</span>,</span>
<span>  <span class="va">was_mean_estimated</span>,</span>
<span>  <span class="va">optimization_info</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">validate_gips</span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>S</dt>
<dd><p>A matrix; estimated covariance matrix.
When Z is the observed data:</p><ul><li><p>if one does not know the theoretical mean and has to
estimate it with the observed mean, use <code>S = cov(Z)</code>, and set
parameter <code>was_mean_estimated = FALSE</code>.</p></li>
<li><p>if one know the theoretical mean is 0, use
<code>S = (t(Z) %*% Z) / number_of_observations</code>, and set
parameter <code>was_mean_estimated = FALSE</code>;</p></li>
</ul></dd>


<dt>number_of_observations</dt>
<dd><p>A number of data points
that <code>S</code> is based on.</p></dd>


<dt>delta</dt>
<dd><p>A hyper-parameter of a Bayesian model.
Has to be bigger than 2.</p></dd>


<dt>D_matrix</dt>
<dd><p>A hyper-parameter of a Bayesian model.
Square matrix of the same size as <code>S</code>.
When NULL, the identity matrix is taken.</p></dd>


<dt>was_mean_estimated</dt>
<dd><p>A logical (TRUE or FALSE).</p><ul><li><p>Set TRUE (default) when your <code>S</code> parameter is a result of
a <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">stats::cov()</a></code> function.</p></li>
<li><p>Set FALSE when your <code>S</code> parameter is a result of
a <code>(t(Z) %*% Z) / number_of_observations</code> calculation.</p></li>
</ul></dd>


<dt>perm</dt>
<dd><p>An optional permutation to be the base for the <code>gips</code> object.
Can be of a <code>gips_perm</code> or a <code>permutation</code> class, or anything
the function <code><a href="https://rdrr.io/pkg/permutations/man/permutation.html" class="external-link">permutations::permutation()</a></code> can handle.</p></dd>


<dt>list_of_gips_perm</dt>
<dd><p>A list with a single element of
a <code>gips_perm</code> class. The base object for the <code>gips</code> object.</p></dd>


<dt>optimization_info</dt>
<dd><p>NULL or the list with
information about the optimization process.</p></dd>


<dt>g</dt>
<dd><p>Element to be checked if it is proper element of a <code>gips</code> class.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>gips()</code> returns an object of
a <code>gips</code> class after the safety checks.</p>


<p><code>new_gips()</code> returns an object of
a <code>gips</code> class without the safety checks.</p>


<p><code>validate_gips()</code> returns its argument unchanged.
If the argument is not a correct element of a <code>gips</code> class,
it produces an error.</p>
    </div>
    <div class="section level2">
    <h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a></h2>
    
<ul><li><p><code>new_gips()</code>: Constructor. Only intended for low-level use.</p></li>
<li><p><code>validate_gips()</code>: Validator. Only intended for low-level use.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="methods-for-a-gips-class">Methods for a <code>gips</code> class<a class="anchor" aria-label="anchor" href="#methods-for-a-gips-class"></a></h2>
    

<ul><li><p><code><a href="summary.gips.html">summary.gips()</a></code></p></li>
<li><p><code><a href="plot.gips.html">plot.gips()</a></code></p></li>
<li><p><code><a href="print.gips.html">print.gips()</a></code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">stats::cov()</a></code> - The <code>S</code> parameter is most of the time
an estimated covariance matrix, so a result of the <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov()</a></code> function.
For more information, see
<a href="https://en.wikipedia.org/wiki/Estimation_of_covariance_matrices" class="external-link">Wikipedia - Estimation of covariance matrices</a>.</p></li>
<li><p><code><a href="find_MAP.html">find_MAP()</a></code> - The function that finds
the Maximum A Posteriori (MAP) Estimator
for a given <code>gips</code> object.</p></li>
<li><p><code><a href="gips_perm.html">gips_perm()</a></code> - The constructor of a <code>gips_perm</code> class.
The <code>gips_perm</code> object is used as the base object for
the <code>gips</code> object. To be more precise, the <code>gips</code> object has
a one-element list of a <code>gips_perm</code> object as the base object.</p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">"MASS"</a></span><span class="op">)</span> <span class="co"># for mvrnorm()</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">perm_size</span> <span class="op">&lt;-</span> <span class="fl">6</span></span></span>
<span class="r-in"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">6</span>, <span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span> <span class="co"># Assume we don't know the mean</span></span></span>
<span class="r-in"><span><span class="va">sigma_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fl">1.0</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    <span class="fl">0.8</span>, <span class="fl">1.0</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>,</span></span>
<span class="r-in"><span>    <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.0</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>,</span></span>
<span class="r-in"><span>    <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.0</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>,</span></span>
<span class="r-in"><span>    <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.0</span>, <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.0</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  nrow <span class="op">=</span> <span class="va">perm_size</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="co"># sigma_matrix is a matrix invariant under permutation (1,2,3,4,5,6)</span></span></span>
<span class="r-in"><span><span class="va">number_of_observations</span> <span class="op">&lt;-</span> <span class="fl">13</span></span></span>
<span class="r-in"><span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">number_of_observations</span>, mu <span class="op">=</span> <span class="va">mu</span>, Sigma <span class="op">=</span> <span class="va">sigma_matrix</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="co"># Assume we have to estimate the mean</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">gips</span><span class="op">(</span><span class="va">S</span>, <span class="va">number_of_observations</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">g_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="find_MAP.html">find_MAP</a></span><span class="op">(</span><span class="va">g</span>, max_iter <span class="op">=</span> <span class="fl">10</span>, show_progress_bar <span class="op">=</span> <span class="cn">FALSE</span>, optimizer <span class="op">=</span> <span class="st">"MH"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g_map</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The permutation (2,5)(3,6) has log posteriori -5.53903324795464 which was found after 10 log_posteriori calculations.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">g_map</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The optimized `gips` object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  (2,5)(3,6)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log_posteriori:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -5.539033</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The mean in `S` matrix was estimated.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Therefore, one degree of freedom was lost.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There is 12 degrees of freedom left.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n0:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations is bigger than n0 for this permutaion,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> so the gips model based on the found permutation does exist.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimization algorithm:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Metropolis_Hastings</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of log_posteriori calls:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimization time:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.02492642 secs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Acceptance rate:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log_posteriori calls after the found permutation:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st">"graphics"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g_map</span>, type <span class="op">=</span> <span class="st">"both"</span>, logarithmic_x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="gips-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Przemyslaw Chojecki, Pawel Morgen, Bartosz Kolodziejek.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

